<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./style.css">

    <title>canvas-demo</title>

    <style>
        body {
            margin: 0;
        }

        #xxx {
            display: block;
        }

        .actions {
            position: fixed;
            top: 0;
            left: 0;
        }
        .actions > #brush{
            display: none;
        }
        .actions.x > #brush{
            display: inline-block;
        }
        .actions.x > #eraser{
            display: none;
        }

    </style>
</head>

<body>

    <canvas id="xxx" width="300" height="300"></canvas>
    <div id="actions" class="actions">
        <button id="eraser">橡皮擦</button>
        <button id="brush">画笔</button>
    </div>


</body>
<script>

    var yyy = document.getElementById('xxx');
    var context = yyy.getContext('2d');

    autoSetCanvasSize(yyy);    //canvas实现全屏

    listenToMouse(yyy);            //监听鼠标事件

    //添加橡皮擦
    var eraserEnabled = false;
    eraser.onclick = function () {
        eraserEnabled = true;
        actions.className = 'actions x';
    }
    brush.onclick = function(){
        eraserEnabled = false;
        actions.className = 'actions';
    }


    //画线，两点之间连接的线
    function drawLine(x1, y1, x2, y2) {
        context.beginPath();
        context.moveTo(x1, y1);  //起点
        context.lineWidth = 5;
        context.lineTo(x2, y2);  //终点
        context.stroke();       //这里要用stroke，不能用fill
        context.closePath();
    }

    //JS获取页面宽高，让canvas全屏,IE不支持
    function autoSetCanvasSize(canvas) {
        CanvasSize();
        //防止用户移动页面是有一部分没有全屏显示
        window.onresize = CanvasSize();
        //获取当前页面宽高，使canvas变为全屏
        function CanvasSize() {
            var pageWidth = document.documentElement.clientWidth;
            var pageHeight = document.documentElement.clientHeight;
            canvas.width = pageWidth;
            canvas.height = pageHeight;
        }
    }

    //监听鼠标事件
    function listenToMouse(canvas) {
        //是否开始用
        var using = false;
        //判断第一个点和第二个点的连线
        var lastPoint = { x: undefined, y: undefined };
        //1.鼠标点击下去
        canvas.onmousedown = function (aaa) {
            var x = aaa.clientX;
            var y = aaa.clientY;
            using = true;
            if (eraserEnabled) {
                context.clearRect(x - 5, y - 5, 10, 10);
            } else {
                lastPoint = { x: x, y: y };
            }
        }
        //2.鼠标移动
        canvas.onmousemove = function (aaa) {
            var x = aaa.clientX;
            var y = aaa.clientY;
            if (!using) {
                return
            }
            if (eraserEnabled) {
                context.clearRect(x - 5, y - 5, 10, 10);
            } else {
                var newPoint = {
                    x: x,
                    y: y
                };
                drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y);
                lastPoint = newPoint;   //最核心的一句话，将两个点之间相连
            }
        }
        //3.鼠标松开
        canvas.onmouseup = function () {
            using = false;
            eraserEnabled = false;
        }
    }

    // //画圆
    // function drawCircle(x, y, radious, ) {
    //     context.beginPath();
    //     context.arc(x, y, radious, 0, Math.PI * 2);
    //     context.fill();
    // }


</script>

</html>